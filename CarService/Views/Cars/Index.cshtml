@model CarService.Models.CarDto

@{
    ViewData["Title"] = "Index";
}

<h1>Avtomobillar ro'yhati</h1>
<div id="app">
    <p>{{salom}}</p>
    @foreach(var item in ViewData["Company"] as List<string>)
     {
        <input type="checkbox" id="@item" value="@item" v-model="salom">
        <label for="@item">@item</label>
     }
    
    <p>
        <a asp-action="Create">Create New</a>
    </p>
        <div class="row g-4 mb-1">
            <div class="col-md">
                <label>Minimum Narx: </label>
                <input v-model="SearchTerms.MinPrice" placeholder="Minimum narxi" />
            </div>
            <div class="col-md">
                <label class="control-label">Maximum Narx: </label>
                <input v-model="SearchTerms.MaxPrice" placeholder="Maximum Narx" />
            </div>
        </div>
        <div class="row g-3 mb-1">
            <div class="form-group col-md">
                @*<label class="control-label">Kompaniyasi: </label>
                <select class="select" v-model="SearchTerms.Company" asp-items="ViewBag.Company">
                    <option value="">Hammasi</option>
                </select>*@
            </div>
            <div class="form-group col-md">
                <label class="control-label">Modellar: </label>
                <select class="select" v-model="SearchTerms.Model" asp-items="ViewBag.Model">
                    <option value="" selected="selected">Hammasi</option>
                </select>
            </div>
            <div class="form-group col-md">
                <label class="control-label">Ranglar: </label>
                <select class="select" v-model="SearchTerms.Color" asp-items="ViewBag.Color">
                    <option value="">Hammasi</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <input type="submit" value="Search" v-on:click="searchByCondition" class="btn btn-primary" />
        </div>
    <table class="table">
        <thead>
            <tr>
                <th>Company</th>
                <th>Modeli</th>
                <th>Color</th>
                <th>Price</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr v-for="car in cars">
                <td>{{car.company}}</td>
                <td>{{car.model}}</td>
                <td>{{car.color}}</td>
                <td>{{car.price}}</td>
                <td>
                    <a asp-action="Edit" asp-route-id="car.id">Edit</a> |
                    <a asp-action="Details" asp-route-id="car.id">Details</a> |
                    <a asp-action="Delete" asp-route-id="car.id">Delete</a>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<script>
    //let router = new VueRouter({
    //mode: 'history',
    //base: __dirname,
    //routes: [
    //    { name: 'cars', path: '/cars'}
    //]
    //})
    const { createApp } = Vue

    const routes = []

const router = VueRouter.createRouter({
  history: VueRouter.createWebHistory(),
  routes, 
})

    let app = createApp({
        data() {
            return {
                salom: [],
                cars: @Html.Raw(Json.Serialize(Model.Cars)),
                SearchTerms: {
                    MinPrice: '',
                    MaxPrice: '',
                    Company: '',
                    Model: '',
                    Color: ''
                }
            }
        },
        mounted: function() {
        },
        methods: {
            searchByCondition() {
                let s = this.SearchTerms;
                //router.addRoute({ path: '/cars',component: app, query: {MinPrice: s.MinPrice,MaxPrice: s.MaxPrice, Company: s.Company,
                //    Model: s.Model, Color: s.Color} });
                window.location.assign('https://' +window.location.hostname+(window.location.port ? (':'+window.location.port) : '') +'/cars'+ '?MinPrice='+s.MinPrice+'&MaxPrice='+s.MaxPrice+'&Company='+s.Company+
                    '&Model='+s.Model+'&Color='+s.Color);
            }
        }
    });
    app.mount('#app');
</script>
